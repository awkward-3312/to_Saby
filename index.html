<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Para ti üíå</title>
  <style>
    :root{
      --bg1:#ffeff6; /* Fondo suave */
      --bg2:#ffe4ea; /* Degradado */
      --rose:#ff6b88; /* Rosa principal */
      --rose-dark:#e75575; /* Rosa oscuro */
      --ink:#333; /* Texto */
      --paper:#fffaf5; /* Papel */
      --shadow:0 20px 50px rgba(0,0,0,.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 600px at 50% -10%, var(--bg2), var(--bg1) 60%);
      color:var(--ink);
      overflow-x:hidden;
    }
    .stage{min-height:100%; display:grid; place-items:center; padding:40px}

    /* Tarjeta / Sobre */
    .envelope-wrap{position:relative; width:min(420px, 86vw); height:min(280px, 56vw); perspective:1200px;}
    .hint{position:absolute; width:100%; text-align:center; top:-36px; font-size:14px; opacity:.8}

    .envelope{position:relative; width:100%; height:100%; border-radius:16px; box-shadow:var(--shadow); transform-style:preserve-3d; cursor:pointer}
    .envelope .back{position:absolute; inset:0; background:linear-gradient(180deg,#fff, #ffe9ee); border:2px solid #ffd1db; border-radius:16px}

    /* Solapa */
    .flap{position:absolute; inset:0; transform-origin:top; transform:rotateX(0deg); transition:transform 900ms cubic-bezier(.2,.8,.2,1); border-radius:16px; background:linear-gradient(180deg,#ffd5df,#ffc0ce); clip-path: polygon(0 0, 100% 0, 50% 58%); box-shadow:inset 0 -10px 40px rgba(0,0,0,.05)}

    /* Cuerpo del sobre */
    .pocket{position:absolute; inset:0; border-radius:16px; background:linear-gradient(180deg,#fff5f7,#ffe0e7); clip-path: polygon(0 0,100% 0,100% 100%,0 100%, 50% 58%); border:2px solid #ffd1db}

    /* Carta (plegada) */
    .letter{position:absolute; left:50%; bottom:14%; transform:translateX(-50%) translateY(0) rotateX(0); width:86%; height:58%; background:var(--paper); border-radius:12px; box-shadow:0 8px 20px rgba(0,0,0,.08); transition:transform 900ms cubic-bezier(.2,.8,.2,1), height 800ms cubic-bezier(.2,.8,.2,1); overflow:hidden; cursor:pointer}

    .letter-head{padding:18px 20px; border-bottom:1px dashed #f0d5d5; background:linear-gradient(180deg,#fff,#fff7f2); font-weight:600; color:#c24a64; display:flex; align-items:center; gap:8px}
    .stamp{margin-left:auto; width:38px; height:30px; border-radius:6px; background: conic-gradient(from 0deg, #ff8fb3, #ffd1db, #ffb3c7, #ff8fb3); opacity:.8}

    .letter-body{padding:18px 20px 60px 20px; line-height:1.6; max-height:0; overflow:hidden; transition:max-height 900ms cubic-bezier(.2,.8,.2,1);}
    .letter-body p{margin:.25rem 0}
    .cta{display:inline-block; margin-top:10px; background:var(--rose); color:white; border:none; padding:10px 14px; border-radius:999px; font-weight:700; cursor:pointer; box-shadow:0 6px 14px rgba(255,107,136,.3)}
    .cta:active{transform:translateY(1px)}

    /* Estado abierto */
    .envelope.open .flap{transform:rotateX(-175deg)}
    .envelope.open .letter{transform:translateX(-50%) translateY(-40%) rotateX(0)}

    /* Carta expandida */
    .letter.expanded{height:90%}
    .letter.expanded .letter-body{max-height:1000px}

    /* Mensajes din√°micos */
    .messages{position:fixed; inset:0; display:grid; place-items:center; pointer-events:none}
    .message-chip{background:#ffffffea; backdrop-filter: blur(6px); border:1px solid #ffd9e3; padding:12px 16px; border-radius:12px; box-shadow:var(--shadow); font-size:18px; animation:pop .35s ease forwards}
    @keyframes pop{from{transform:scale(.9); opacity:0} to{transform:scale(1); opacity:1}}

    /* Part√≠culas (flores, corazones, confeti) */
    .particle{position:fixed; top:-40px; font-size:24px; will-change:transform, opacity; animation:fall linear forwards;}
    @keyframes fall{to{transform:translateY(110vh) rotate(360deg); opacity:.9}}

    /* Botonera final */
    .final{display:flex; gap:12px; margin-top:12px}
    .btn{background:var(--rose); color:#fff; border:none; padding:10px 18px; border-radius:12px; font-weight:700; cursor:pointer; box-shadow:0 8px 18px rgba(255,107,136,.35)}
    .btn.alt{background:#ffd1db; color:#c24a64}

    /* Footer sutil */
    .footer{position:fixed; bottom:10px; left:0; right:0; text-align:center; font-size:12px; opacity:.6}

    /* Responsivo */
    @media (max-width:480px){
      .envelope-wrap{height:58vw}
      .letter.expanded{height:96%}
    }
  </style>
</head>
<body>
  <main class="stage" aria-live="polite">
    <div class="envelope-wrap">
      <div class="hint">Toca el sobre para abrirlo</div>
      <div class="envelope" id="envelope" role="button" aria-label="Abrir sobre">
        <div class="back"></div>
        <div class="flap"></div>
        <div class="pocket"></div>
        <section class="letter" id="letter" aria-label="Abrir carta">
          <header class="letter-head">
            <span>Para: <strong>Ti</strong> üíñ</span>
            <div class="stamp" aria-hidden="true"></div>
          </header>
          <div class="letter-body" id="letterBody">
            <p>Hola,</p>
            <p>Desde que te conoc√≠, mi mundo empez√≥ a sonre√≠r con m√°s fuerza. Cada d√≠a contigo se siente como la parte favorita de mi canci√≥n favorita.</p>
            <p>Me encanta c√≥mo iluminas todo a tu alrededor.</p>
            <button class="cta" id="seeMore">Ver m√°s‚Ä¶</button>
          </div>
        </section>
      </div>
    </div>

    <div class="messages" id="messages" aria-live="polite"></div>
  </main>

  <div class="footer">Hecho con HTML, CSS y JS ‚Äî por alguien que piensa en ti ü´∂</div>

  <script>
    const envelope = document.getElementById('envelope');
    const letter = document.getElementById('letter');
    const letterBody = document.getElementById('letterBody');
    const seeMore = document.getElementById('seeMore');
    const messages = document.getElementById('messages');

    let phase = 0; // 0: cerrado, 1: sobre abierto, 2: carta expandida, 3: celebraci√≥n
    let msgIndex = 0;

    const compliments = [
      'Eres mi casualidad favorita ‚ú®',
      'Tu risa es la banda sonora de mis d√≠as üé∂',
      'Si estuvieras en el cielo, robar√≠as miradas hasta a las estrellas üåü',
      'Me haces creer en lo bonito de lo simple üåà',
      'Mi lugar seguro siempre coincide contigo üè°',
      'Donde est√©s t√∫, est√° mi mejor versi√≥n üí´',
      'Prometo cuidar de tu coraz√≥n como si fuera el m√≠o ‚ù§Ô∏è',
      'Mi coraz√≥n ya no puede m√°s‚Ä¶'
    ];

    const petals = ['üå∏','üíê','üåπ','üå∑','üå∫','üíÆ'];
    const hearts = ['üíñ','üíó','üíì','üíû','üíï','‚ù§Ô∏è'];

    function openEnvelope(){
      if(phase>0) return;
      envelope.classList.add('open');
      setTimeout(()=>{ // levanta un poco la carta
        letter.style.transform = 'translateX(-50%) translateY(-60%)';
      }, 500);
      phase = 1;
    }

    function expandLetter(){
      if(phase!==1) return;
      letter.classList.add('expanded');
      phase = 2;
    }

    function spawnParticle(icon){
      const el = document.createElement('div');
      el.className='particle';
      el.textContent = icon;
      const duration = 6000 + Math.random()*3000;
      const startX = Math.random()*100; // vw
      const rotate = (Math.random()*2-1)*720; // -720 a 720
      el.style.left = startX+'vw';
      el.style.animationDuration = duration+'ms';
      el.style.transform = `translateY(-40px) rotate(${rotate}deg)`;
      document.body.appendChild(el);
      setTimeout(()=> el.remove(), duration+200);
    }

    function confettiBurst(){
      // Mezcla corazones y p√©talos
      const icons = [...hearts, ...petals];
      for(let i=0;i<30;i++){
        setTimeout(()=>{
          const icon = icons[Math.floor(Math.random()*icons.length)];
          spawnParticle(icon);
        }, i*60);
      }
    }

    function toast(text){
      const chip = document.createElement('div');
      chip.className='message-chip';
      chip.textContent = text;
      messages.appendChild(chip);
      setTimeout(()=> chip.remove(), 3000);
    }

    function nextCompliment(){
      if(msgIndex < compliments.length){
        const text = compliments[msgIndex++];
        toast(text);
        confettiBurst();
        if(text.includes('Mi coraz√≥n ya no puede m√°s‚Ä¶')){
          // Mostrar prompt final tras un peque√±o delay
          setTimeout(showFinalPrompt, 1200);
        }
      } else {
        // si ya se acab√≥, vuelve a lanzar confeti para mantener la magia
        confettiBurst();
      }
    }

    function showFinalPrompt(){
      // Limpiar chip persistente si quedara alguno
      const chip = document.createElement('div');
      chip.className='message-chip';
      chip.innerHTML = '<div style="text-align:center">¬øQuieres ser mi novia? üíç<div class="final"><button class="btn" id="yes1">S√≠</button><button class="btn alt" id="yes2">Obvio que s√≠</button></div></div>';
      messages.appendChild(chip);

      const yes1 = chip.querySelector('#yes1');
      const yes2 = chip.querySelector('#yes2');
      [yes1, yes2].forEach(btn=> btn.addEventListener('click', ()=>{
        confettiBurst();
        toast('¬°Prometo hacerte feliz cada d√≠a! ü´∂');
      }));
    }

    // Eventos
    envelope.addEventListener('click', openEnvelope);
    letter.addEventListener('click', expandLetter);

    seeMore.addEventListener('click', (e)=>{
      e.stopPropagation();
      if(phase<2) return; // a√∫n no est√° expandida
      if(phase===2){
        phase = 3;
      }
      nextCompliment();
    });

    // Accesibilidad con teclado
    envelope.tabIndex = 0; letter.tabIndex = 0;
    envelope.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ openEnvelope(); }});
    letter.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ expandLetter(); }});
  </script>
</body>
</html>